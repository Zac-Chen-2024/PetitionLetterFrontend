(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,563,e=>{"use strict";var t=e.i(43476),i=e.i(71645),s=e.i(70703),a=e.i(81917);let n=(0,s.default)(()=>e.A(26187),{loadableGenerated:{modules:[64660]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("div",{className:"w-6 h-6 border-2 border-rose-500 border-t-transparent rounded-full animate-spin"})})}),l=e=>({person:"#93C5FD",organization:"#C4B5FD",company:"#86EFAC",date:"#FDE047",location:"#FDBA74",position:"#F9A8D4",event:"#67E8F9",document:"#D1D5DB"})[e]||"#E5E7EB",r=(e,t)=>({person:t.relationship.entityTypes.person,organization:t.relationship.entityTypes.organization,company:t.relationship.entityTypes.company,date:t.relationship.entityTypes.date,location:t.relationship.entityTypes.location,position:t.relationship.entityTypes.position,event:t.relationship.entityTypes.event,document:t.relationship.entityTypes.document})[e]||e,o=({visible:e,x:i,y:s,content:a})=>e?(0,t.jsx)("div",{className:"absolute z-50 bg-white rounded-lg shadow-lg border border-gray-200 p-3 max-w-xs pointer-events-none",style:{left:i+10,top:s+10,transform:"translateY(-50%)"},children:a}):null;function d({entities:e,relations:s}){let{t:d}=(0,a.useLanguage)(),c=(0,i.useRef)(null),[h,p]=(0,i.useState)({width:600,height:400}),[m,y]=(0,i.useState)({visible:!1,x:0,y:0,content:null}),[x,u]=(0,i.useState)(new Set),[g,f]=(0,i.useState)(new Set),b=(0,i.useMemo)(()=>({nodes:e.map(e=>({id:e.id,name:e.name,type:e.type,documents:e.documents,color:l(e.type),val:1})),links:s.map(e=>({source:e.source_id,target:e.target_id,type:e.relation_type,description:e.description,evidence:e.evidence,color:"#E5E7EB"}))}),[e,s]);(0,i.useEffect)(()=>{let e=()=>{if(c.current){let{width:e}=c.current.getBoundingClientRect();p({width:e,height:400})}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let v=(0,i.useCallback)(e=>{if(e){let i=new Set,a=new Set;i.add(e.id),s.forEach(t=>{(t.source_id===e.id||t.target_id===e.id)&&(i.add(t.source_id),i.add(t.target_id),a.add(`${t.source_id}-${t.target_id}`))}),u(i),f(a);let n=(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("div",{className:"font-medium text-gray-900 mb-1",children:e.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-2",children:[d.relationship.graph.type,": ",r(e.type,d)]}),e.documents&&e.documents.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:[d.relationship.graph.sourceDocuments,":"]}),(0,t.jsxs)("ul",{className:"text-xs text-gray-600",children:[e.documents.slice(0,3).map((e,i)=>(0,t.jsxs)("li",{className:"truncate",children:["• ",e]},i)),e.documents.length>3&&(0,t.jsxs)("li",{className:"text-gray-400",children:["+",e.documents.length-3," more"]})]})]})]}),l=c.current?.getBoundingClientRect();l&&void 0!==e.x&&void 0!==e.y&&y({visible:!0,x:(e.x||0)+l.width/2,y:(e.y||0)+l.height/2,content:n})}else u(new Set),f(new Set),y({visible:!1,x:0,y:0,content:null})},[s,d]),w=(0,i.useCallback)(i=>{if(i){var s;let a="string"==typeof i.source?i.source:i.source?.id,n="string"==typeof i.target?i.target:i.target?.id,l=e.find(e=>e.id===a),r=e.find(e=>e.id===n),o=(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("div",{className:"font-medium text-gray-900 mb-2",children:[l?.name||"?"," → ",(s=i.type,({works_for:d.relationship.relationTypes.works_for,owns:d.relationship.relationTypes.owns,subsidiary_of:d.relationship.relationTypes.subsidiary_of,affiliated_with:d.relationship.relationTypes.affiliated_with,employed_by:d.relationship.relationTypes.employed_by,manages:d.relationship.relationTypes.manages,reports_to:d.relationship.relationTypes.reports_to,founded:d.relationship.relationTypes.founded,located_in:d.relationship.relationTypes.located_in})[s]||s)," → ",r?.name||"?"]}),i.description&&(0,t.jsx)("div",{className:"text-xs text-gray-600 mb-2",children:i.description}),i.evidence&&i.evidence.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:[d.relationship.graph.evidence,":"]}),(0,t.jsxs)("ul",{className:"text-xs text-gray-600",children:[i.evidence.slice(0,2).map((e,i)=>(0,t.jsxs)("li",{className:"line-clamp-2",children:['"',e,'"']},i)),i.evidence.length>2&&(0,t.jsxs)("li",{className:"text-gray-400",children:["+",i.evidence.length-2," more"]})]})]})]}),h=i.source,p=i.target;if(h?.x!==void 0&&p?.x!==void 0){let e=c.current?.getBoundingClientRect();e&&y({visible:!0,x:(h.x+p.x)/2+e.width/2,y:(h.y+p.y)/2+e.height/2,content:o})}}else y({visible:!1,x:0,y:0,content:null})},[e,d]),j=(0,i.useCallback)(e=>{let t=new Set,i=new Set;t.add(e.id),s.forEach(s=>{(s.source_id===e.id||s.target_id===e.id)&&(t.add(s.source_id),t.add(s.target_id),i.add(`${s.source_id}-${s.target_id}`))}),u(t),f(i)},[s]),N=(0,i.useCallback)(()=>{u(new Set),f(new Set)},[]),T=(0,i.useCallback)((e,t,i)=>{let s=e.name||"",a=14/i;t.font=`${a}px -apple-system, BlinkMacSystemFont, sans-serif`;let n=0===x.size||x.has(e.id),l=n&&x.size>0?12:10;t.save(),t.shadowColor=n&&x.size>0?"rgba(0,0,0,0.15)":"rgba(0,0,0,0.1)",t.shadowBlur=n&&x.size>0?12:8,t.shadowOffsetX=0,t.shadowOffsetY=2,t.beginPath(),t.arc(e.x||0,e.y||0,l,0,2*Math.PI,!1),t.fillStyle=n&&e.color||"#E5E7EB",t.fill(),t.shadowColor="transparent",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.strokeStyle="#FFFFFF",t.lineWidth=2/i,t.stroke(),t.restore(),t.textAlign="center",t.textBaseline="middle",t.fillStyle=n?"#374151":"#9CA3AF",t.fillText(s,e.x||0,(e.y||0)+l+a+2)},[x]),_=(0,i.useCallback)((e,t,i)=>{let s=e.source,a=e.target;if(!s?.x||!s?.y||!a?.x||!a?.y)return;let n="string"==typeof e.source?e.source:s?.id,l="string"==typeof e.target?e.target:a?.id,r=`${n}-${l}`,o=g.has(r);t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(a.x,a.y),t.strokeStyle=o?"#F43F5E":"#E5E7EB",t.lineWidth=o?2/i:1/i,t.stroke();let d=8/i,c=Math.atan2(a.y-s.y,a.x-s.x),h=(s.x+a.x)/2,p=(s.y+a.y)/2;t.beginPath(),t.moveTo(h,p),t.lineTo(h-d*Math.cos(c-Math.PI/6),p-d*Math.sin(c-Math.PI/6)),t.lineTo(h-d*Math.cos(c+Math.PI/6),p-d*Math.sin(c+Math.PI/6)),t.closePath(),t.fillStyle=o?"#F43F5E":"#D1D5DB",t.fill()},[g]);return 0===e.length?(0,t.jsx)("div",{className:"h-[400px] flex items-center justify-center text-gray-400",children:(0,t.jsx)("p",{className:"text-sm",children:d.relationship.noEntitiesOrRelations})}):(0,t.jsxs)("div",{ref:c,className:"relative h-[400px] bg-white border border-gray-100 rounded-lg overflow-hidden shadow-sm",children:[(0,t.jsx)(n,{graphData:b,width:h.width,height:h.height,nodeCanvasObject:T,linkCanvasObject:_,onNodeHover:v,onLinkHover:w,onNodeClick:j,onBackgroundClick:N,nodeRelSize:6,linkDirectionalArrowLength:0,cooldownTicks:100,d3AlphaDecay:.02,d3VelocityDecay:.3,enableNodeDrag:!0,enableZoomInteraction:!0,enablePanInteraction:!0}),(0,t.jsx)(o,{...m}),(0,t.jsx)("div",{className:"absolute bottom-3 left-3 bg-white/95 backdrop-blur-sm rounded-xl px-4 py-2.5 text-xs shadow-md border border-gray-100",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-3",children:["person","organization","company","location"].map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:l(e)}}),(0,t.jsx)("span",{className:"text-gray-600",children:r(e,d)})]},e))})})]})}e.s(["default",()=>d])},66673,e=>{e.n(e.i(563))},26187,e=>{e.v(t=>Promise.all(["static/chunks/d740a489fc9bf15b.js"].map(t=>e.l(t))).then(()=>t(64660)))}]);
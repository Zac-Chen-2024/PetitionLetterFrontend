(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,563,e=>{"use strict";var t=e.i(43476),i=e.i(71645),s=e.i(70703),n=e.i(81917);let a=(0,s.default)(()=>e.A(26187),{loadableGenerated:{modules:[64660]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("div",{className:"w-6 h-6 border-2 border-rose-500 border-t-transparent rounded-full animate-spin"})})}),l=e=>({person:"#3B82F6",organization:"#8B5CF6",company:"#22C55E",date:"#EAB308",location:"#F97316",position:"#EC4899",event:"#06B6D4",document:"#6B7280"})[e]||"#9CA3AF",o=(e,t)=>({person:t.relationship.entityTypes.person,organization:t.relationship.entityTypes.organization,company:t.relationship.entityTypes.company,date:t.relationship.entityTypes.date,location:t.relationship.entityTypes.location,position:t.relationship.entityTypes.position,event:t.relationship.entityTypes.event,document:t.relationship.entityTypes.document})[e]||e,r=({visible:e,x:i,y:s,content:n})=>e?(0,t.jsx)("div",{className:"absolute z-50 bg-white rounded-lg shadow-lg border border-gray-200 p-3 max-w-xs pointer-events-none",style:{left:i+10,top:s+10,transform:"translateY(-50%)"},children:n}):null;function d({entities:e,relations:s}){let{t:d}=(0,n.useLanguage)(),c=(0,i.useRef)(null),[h,p]=(0,i.useState)({width:600,height:400}),[y,x]=(0,i.useState)({visible:!1,x:0,y:0,content:null}),[m,u]=(0,i.useState)(new Set),[g,f]=(0,i.useState)(new Set),v=(0,i.useMemo)(()=>({nodes:e.map(e=>({id:e.id,name:e.name,type:e.type,documents:e.documents,color:l(e.type),val:1})),links:s.map(e=>({source:e.source_id,target:e.target_id,type:e.relation_type,description:e.description,evidence:e.evidence,color:"#E5E7EB"}))}),[e,s]);(0,i.useEffect)(()=>{let e=()=>{if(c.current){let{width:e}=c.current.getBoundingClientRect();p({width:e,height:400})}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let b=(0,i.useCallback)(e=>{if(e){let i=new Set,n=new Set;i.add(e.id),s.forEach(t=>{(t.source_id===e.id||t.target_id===e.id)&&(i.add(t.source_id),i.add(t.target_id),n.add(`${t.source_id}-${t.target_id}`))}),u(i),f(n);let a=(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("div",{className:"font-medium text-gray-900 mb-1",children:e.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-2",children:[d.relationship.graph.type,": ",o(e.type,d)]}),e.documents&&e.documents.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:[d.relationship.graph.sourceDocuments,":"]}),(0,t.jsxs)("ul",{className:"text-xs text-gray-600",children:[e.documents.slice(0,3).map((e,i)=>(0,t.jsxs)("li",{className:"truncate",children:["• ",e]},i)),e.documents.length>3&&(0,t.jsxs)("li",{className:"text-gray-400",children:["+",e.documents.length-3," more"]})]})]})]}),l=c.current?.getBoundingClientRect();l&&void 0!==e.x&&void 0!==e.y&&x({visible:!0,x:(e.x||0)+l.width/2,y:(e.y||0)+l.height/2,content:a})}else u(new Set),f(new Set),x({visible:!1,x:0,y:0,content:null})},[s,d]),w=(0,i.useCallback)(i=>{if(i){var s;let n="string"==typeof i.source?i.source:i.source?.id,a="string"==typeof i.target?i.target:i.target?.id,l=e.find(e=>e.id===n),o=e.find(e=>e.id===a),r=(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("div",{className:"font-medium text-gray-900 mb-2",children:[l?.name||"?"," → ",(s=i.type,({works_for:d.relationship.relationTypes.works_for,owns:d.relationship.relationTypes.owns,subsidiary_of:d.relationship.relationTypes.subsidiary_of,affiliated_with:d.relationship.relationTypes.affiliated_with,employed_by:d.relationship.relationTypes.employed_by,manages:d.relationship.relationTypes.manages,reports_to:d.relationship.relationTypes.reports_to,founded:d.relationship.relationTypes.founded,located_in:d.relationship.relationTypes.located_in})[s]||s)," → ",o?.name||"?"]}),i.description&&(0,t.jsx)("div",{className:"text-xs text-gray-600 mb-2",children:i.description}),i.evidence&&i.evidence.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:[d.relationship.graph.evidence,":"]}),(0,t.jsxs)("ul",{className:"text-xs text-gray-600",children:[i.evidence.slice(0,2).map((e,i)=>(0,t.jsxs)("li",{className:"line-clamp-2",children:['"',e,'"']},i)),i.evidence.length>2&&(0,t.jsxs)("li",{className:"text-gray-400",children:["+",i.evidence.length-2," more"]})]})]})]}),h=i.source,p=i.target;if(h?.x!==void 0&&p?.x!==void 0){let e=c.current?.getBoundingClientRect();e&&x({visible:!0,x:(h.x+p.x)/2+e.width/2,y:(h.y+p.y)/2+e.height/2,content:r})}}else x({visible:!1,x:0,y:0,content:null})},[e,d]),j=(0,i.useCallback)(e=>{let t=new Set,i=new Set;t.add(e.id),s.forEach(s=>{(s.source_id===e.id||s.target_id===e.id)&&(t.add(s.source_id),t.add(s.target_id),i.add(`${s.source_id}-${s.target_id}`))}),u(t),f(i)},[s]),N=(0,i.useCallback)(()=>{u(new Set),f(new Set)},[]),T=(0,i.useCallback)((e,t,i)=>{let s=e.name||"",n=12/i;t.font=`${n}px Sans-Serif`;let a=0===m.size||m.has(e.id);t.beginPath(),t.arc(e.x||0,e.y||0,6,0,2*Math.PI,!1),t.fillStyle=a?e.color||"#9CA3AF":"#D1D5DB",t.fill(),a&&m.size>0&&(t.strokeStyle=e.color||"#9CA3AF",t.lineWidth=2/i,t.stroke()),t.textAlign="center",t.textBaseline="middle",t.fillStyle=a?"#1F2937":"#9CA3AF",t.fillText(s,e.x||0,(e.y||0)+6+n)},[m]),_=(0,i.useCallback)((e,t,i)=>{let s=e.source,n=e.target;if(!s?.x||!s?.y||!n?.x||!n?.y)return;let a="string"==typeof e.source?e.source:s?.id,l="string"==typeof e.target?e.target:n?.id,o=`${a}-${l}`,r=0===g.size||g.has(o);t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(n.x,n.y),t.strokeStyle=r?"#F43F5E":"#E5E7EB",t.lineWidth=r?2/i:1/i,t.stroke();let d=8/i,c=Math.atan2(n.y-s.y,n.x-s.x),h=(s.x+n.x)/2,p=(s.y+n.y)/2;t.beginPath(),t.moveTo(h,p),t.lineTo(h-d*Math.cos(c-Math.PI/6),p-d*Math.sin(c-Math.PI/6)),t.lineTo(h-d*Math.cos(c+Math.PI/6),p-d*Math.sin(c+Math.PI/6)),t.closePath(),t.fillStyle=r?"#F43F5E":"#D1D5DB",t.fill()},[g]);return 0===e.length?(0,t.jsx)("div",{className:"h-[400px] flex items-center justify-center text-gray-400",children:(0,t.jsx)("p",{className:"text-sm",children:d.relationship.noEntitiesOrRelations})}):(0,t.jsxs)("div",{ref:c,className:"relative h-[400px] bg-gray-50 rounded-lg overflow-hidden",children:[(0,t.jsx)(a,{graphData:v,width:h.width,height:h.height,nodeCanvasObject:T,linkCanvasObject:_,onNodeHover:b,onLinkHover:w,onNodeClick:j,onBackgroundClick:N,nodeRelSize:6,linkDirectionalArrowLength:0,cooldownTicks:100,d3AlphaDecay:.02,d3VelocityDecay:.3,enableNodeDrag:!0,enableZoomInteraction:!0,enablePanInteraction:!0}),(0,t.jsx)(r,{...y}),(0,t.jsx)("div",{className:"absolute bottom-2 left-2 bg-white/90 rounded-lg px-3 py-2 text-xs shadow-sm",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-3",children:["person","organization","company","location"].map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:l(e)}}),(0,t.jsx)("span",{className:"text-gray-600",children:o(e,d)})]},e))})})]})}e.s(["default",()=>d])},66673,e=>{e.n(e.i(563))},26187,e=>{e.v(t=>Promise.all(["static/chunks/d740a489fc9bf15b.js"].map(t=>e.l(t))).then(()=>t(64660)))}]);
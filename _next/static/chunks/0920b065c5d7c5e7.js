(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,563,e=>{"use strict";var t=e.i(43476),i=e.i(71645),r=e.i(81917);let n=[{key:"all",labelKey:"all"},{key:"relationship",labelKey:"qualifying_relationship"},{key:"employment",labelKey:"qualifying_employment"},{key:"capacity",labelKey:"qualifying_capacity"},{key:"business",labelKey:"doing_business"}],s={all:[],relationship:["subsidiary_of","owns","affiliated_with"],employment:["employed_by","works_for"],capacity:["manages","reports_to"],business:["located_in","founded"]},a={all:[],relationship:["company","organization"],employment:["person","company","organization"],capacity:["person","position"],business:["company","organization","location"]},l=(e,t)=>({works_for:t.relationship.relationTypes.works_for,employed_by:t.relationship.relationTypes.employed_by,owns:t.relationship.relationTypes.owns,subsidiary_of:t.relationship.relationTypes.subsidiary_of,affiliated_with:t.relationship.relationTypes.affiliated_with,manages:t.relationship.relationTypes.manages,reports_to:t.relationship.relationTypes.reports_to,founded:t.relationship.relationTypes.founded,located_in:t.relationship.relationTypes.located_in})[e]||e,o=(e,t)=>({companies:t.relationship.entityTypes.company,persons:t.relationship.entityTypes.person,others:t.relationship.graphLayers?.others||"Other"})[e]||e,p=(0,i.forwardRef)(({entity:e,t:i},r)=>{var n;let s={person:"border-blue-400",organization:"border-purple-400",company:"border-green-400",location:"border-orange-400",position:"border-pink-400",date:"border-cyan-400",event:"border-indigo-400",document:"border-amber-400"}[e.type]||"border-gray-300",a={person:"bg-blue-50",organization:"bg-purple-50",company:"bg-green-50",location:"bg-orange-50",position:"bg-pink-50",date:"bg-cyan-50",event:"bg-indigo-50",document:"bg-amber-50"}[e.type]||"bg-gray-50",l=(n=e.type,({person:i.relationship.entityTypes.person,organization:i.relationship.entityTypes.organization,company:i.relationship.entityTypes.company,location:i.relationship.entityTypes.location,position:i.relationship.entityTypes.position})[n]||n);return(0,t.jsxs)("div",{ref:r,className:`relative px-4 py-3 rounded-lg border-2 ${s} ${a} min-w-[120px] max-w-[180px]`,children:[(0,t.jsx)("span",{className:"absolute -top-2.5 left-3 px-2 text-xs bg-white text-gray-500 whitespace-nowrap",children:l}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-800 text-center truncate",children:e.name})]})});p.displayName="EntityNode";let d=({title:e,children:i})=>(0,t.jsxs)("div",{className:"relative py-6",children:[(0,t.jsx)("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 text-xs text-gray-400 bg-white px-1 z-10",style:{writingMode:"vertical-rl",textOrientation:"mixed",transform:"rotate(180deg) translateY(50%)"},children:e}),(0,t.jsx)("div",{className:"flex justify-center gap-8 flex-wrap pl-6",children:i})]}),c=({relation:e,entities:i,t:r})=>{let n=i.find(t=>t.id===e.source_id),s=i.find(t=>t.id===e.target_id);return n&&s?(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-50 rounded text-xs text-gray-600",children:[(0,t.jsx)("span",{className:"font-medium",children:n.name}),(0,t.jsx)("span",{className:"text-rose-500",children:"→"}),(0,t.jsx)("span",{className:"text-rose-600",children:l(e.relation_type,r)}),(0,t.jsx)("span",{className:"text-rose-500",children:"→"}),(0,t.jsx)("span",{className:"font-medium",children:s.name})]}):null};function y({entities:e,relations:y}){let{t:h}=(0,r.useLanguage)(),[m,g]=(0,i.useState)("all"),u=(0,i.useRef)(null),[x,f]=(0,i.useState)(null),b=(0,i.useRef)(new Map),[,j]=(0,i.useState)({}),{entities:w,relations:_}=(0,i.useMemo)(()=>((e,t,i)=>{if("all"===e)return{entities:t,relations:i};let r=s[e],n=a[e],l=i.filter(e=>r.includes(e.relation_type)),o=new Set;return l.forEach(e=>{o.add(e.source_id),o.add(e.target_id)}),{entities:l.length>0?t.filter(e=>o.has(e.id)):t.filter(e=>n.includes(e.type)),relations:l}})(m,e,y),[m,e,y]),v=(0,i.useMemo)(()=>({companies:w.filter(e=>["company","organization"].includes(e.type)),persons:w.filter(e=>"person"===e.type),others:w.filter(e=>!["company","organization","person"].includes(e.type))}),[w]),N=(0,i.useCallback)((e,t)=>{t?b.current.set(e,t):b.current.delete(e)},[]);if((0,i.useEffect)(()=>{let e=setTimeout(()=>{u.current&&(f(u.current.getBoundingClientRect()),j({}))},100);return()=>clearTimeout(e)},[w,_,m]),(0,i.useEffect)(()=>{let e=()=>{u.current&&(f(u.current.getBoundingClientRect()),j({}))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),0===e.length)return(0,t.jsx)("div",{className:"h-[200px] flex items-center justify-center text-gray-400",children:(0,t.jsx)("p",{className:"text-sm",children:h.relationship.noEntitiesOrRelations})});let k=v.companies.length>0||v.persons.length>0||v.others.length>0;return(0,t.jsxs)("div",{className:"bg-white border border-gray-100 rounded-lg",children:[(0,t.jsx)("div",{className:"border-b border-gray-100 px-4 pt-4",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:n.map(e=>{var i;let r;return(0,t.jsx)("button",{onClick:()=>g(e.key),className:`px-3 py-2 text-xs font-medium rounded-t-lg transition-colors ${m===e.key?"bg-rose-50 text-rose-700 border-b-2 border-rose-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:(i=e.labelKey,(r=h.relationship.graphTabs)&&"object"==typeof r&&i in r?r[i]:({all:"Overview",qualifying_relationship:"Corporate",qualifying_employment:"Employment",qualifying_capacity:"Capacity",doing_business:"Operations"})[i]||i)},e.key)})})}),(0,t.jsx)("div",{ref:u,className:"relative p-6 min-h-[400px]",children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-4",children:[v.companies.length>0&&(0,t.jsx)(d,{title:o("companies",h),children:v.companies.map(e=>(0,t.jsx)(p,{entity:e,t:h,ref:t=>N(e.id,t)},e.id))}),v.persons.length>0&&(0,t.jsx)(d,{title:o("persons",h),children:v.persons.map(e=>(0,t.jsx)(p,{entity:e,t:h,ref:t=>N(e.id,t)},e.id))}),v.others.length>0&&(0,t.jsx)(d,{title:o("others",h),children:v.others.map(e=>(0,t.jsx)(p,{entity:e,t:h,ref:t=>N(e.id,t)},e.id))})]}),x&&(0,t.jsxs)("svg",{className:"absolute inset-0 pointer-events-none",style:{overflow:"visible",width:"100%",height:"100%"},children:[(0,t.jsx)("defs",{children:(0,t.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:(0,t.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:"#94a3b8"})})}),_.map((e,i)=>{let r,n,s,a,o,p=b.current.get(e.source_id),d=b.current.get(e.target_id);if(!p||!d||!u.current)return null;let c=p.getBoundingClientRect(),y=d.getBoundingClientRect(),m=u.current.getBoundingClientRect(),{path:g,midX:x,midY:f}=(r=c.left+c.width/2-m.left,n=c.bottom-m.top,s=y.left+y.width/2-m.left,o=(n+(a=y.top-m.top))/2,{path:`M ${r} ${n} C ${r} ${o}, ${s} ${o}, ${s} ${a}`,midX:(r+s)/2,midY:o}),j=l(e.relation_type,h),w=7*j.length+16;return(0,t.jsxs)("g",{children:[(0,t.jsx)("path",{d:g,stroke:"#cbd5e1",strokeWidth:"2",fill:"none",markerEnd:"url(#arrowhead)"}),(0,t.jsx)("rect",{x:x-w/2,y:f-10,width:w,height:"20",fill:"white",rx:"4",stroke:"#fecdd3",strokeWidth:"1"}),(0,t.jsx)("text",{x:x,y:f+4,textAnchor:"middle",fontSize:"11",fill:"#e11d48",children:j})]},i)})]}),_.length>0&&(0,t.jsxs)("div",{className:"mt-8 pt-4 border-t border-gray-100",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:[h.relationship.relationDetails||"Relation Details",":"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:_.map((i,r)=>(0,t.jsx)(c,{relation:i,entities:e,t:h},r))})]})]}):(0,t.jsx)("div",{className:"h-[200px] flex items-center justify-center text-gray-400",children:(0,t.jsx)("p",{className:"text-sm",children:h.relationship.noEntitiesOrRelations})})})]})}e.s(["default",()=>y])},66673,e=>{e.n(e.i(563))}]);
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,563,e=>{"use strict";var t=e.i(43476),i=e.i(71645),r=e.i(81917);let n=[{key:"all",labelKey:"all"},{key:"relationship",labelKey:"qualifying_relationship"},{key:"employment",labelKey:"qualifying_employment"},{key:"capacity",labelKey:"qualifying_capacity"},{key:"business",labelKey:"doing_business"}],s={all:[],relationship:["subsidiary_of","owns","affiliated_with"],employment:["employed_by","works_for"],capacity:["manages","reports_to"],business:["located_in","founded"]},a={all:[],relationship:["company","organization"],employment:["person","company","organization"],capacity:["person","position"],business:["company","organization","location"]},l=(e,t)=>({works_for:t.relationship.relationTypes.works_for,employed_by:t.relationship.relationTypes.employed_by,owns:t.relationship.relationTypes.owns,subsidiary_of:t.relationship.relationTypes.subsidiary_of,affiliated_with:t.relationship.relationTypes.affiliated_with,manages:t.relationship.relationTypes.manages,reports_to:t.relationship.relationTypes.reports_to,founded:t.relationship.relationTypes.founded,located_in:t.relationship.relationTypes.located_in})[e]||e,o=(e,t)=>({companies:t.relationship.entityTypes.company,persons:t.relationship.entityTypes.person,others:t.relationship.graphLayers?.others||"Other"})[e]||e,p=(0,i.forwardRef)(({entity:e,t:i},r)=>{var n;let s={person:"border-blue-400",organization:"border-purple-400",company:"border-green-400",location:"border-orange-400",position:"border-pink-400",date:"border-cyan-400",event:"border-indigo-400",document:"border-amber-400"}[e.type]||"border-gray-300",a={person:"bg-blue-50",organization:"bg-purple-50",company:"bg-green-50",location:"bg-orange-50",position:"bg-pink-50",date:"bg-cyan-50",event:"bg-indigo-50",document:"bg-amber-50"}[e.type]||"bg-gray-50",l=(n=e.type,({person:i.relationship.entityTypes.person,organization:i.relationship.entityTypes.organization,company:i.relationship.entityTypes.company,location:i.relationship.entityTypes.location,position:i.relationship.entityTypes.position})[n]||n);return(0,t.jsxs)("div",{ref:r,className:`relative px-4 py-3 rounded-lg border-2 ${s} ${a} min-w-[120px] max-w-[180px] z-10`,children:[(0,t.jsx)("span",{className:"absolute -top-2.5 left-3 px-2 text-xs bg-white text-gray-500 whitespace-nowrap",children:l}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-800 text-center truncate",children:e.name})]})});p.displayName="EntityNode";let d=({title:e,children:i})=>(0,t.jsxs)("div",{className:"relative py-6",children:[(0,t.jsx)("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 text-xs text-gray-400 bg-white px-1 z-20",style:{writingMode:"vertical-rl",textOrientation:"mixed",transform:"rotate(180deg) translateY(50%)"},children:e}),(0,t.jsx)("div",{className:"flex justify-center gap-8 flex-wrap pl-6",children:i})]}),c=({relation:e,entities:i,t:r})=>{let n=i.find(t=>t.id===e.source_id),s=i.find(t=>t.id===e.target_id);return n&&s?(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-50 rounded text-xs text-gray-600",children:[(0,t.jsx)("span",{className:"font-medium",children:n.name}),(0,t.jsx)("span",{className:"text-rose-500",children:"→"}),(0,t.jsx)("span",{className:"text-rose-600",children:l(e.relation_type,r)}),(0,t.jsx)("span",{className:"text-rose-500",children:"→"}),(0,t.jsx)("span",{className:"font-medium",children:s.name})]}):null};function h({entities:e,relations:h}){let{t:y}=(0,r.useLanguage)(),[m,g]=(0,i.useState)("all"),u=(0,i.useRef)(null),[x,f]=(0,i.useState)(null),b=(0,i.useRef)(new Map),[,j]=(0,i.useState)({}),{entities:_,relations:w}=(0,i.useMemo)(()=>((e,t,i)=>{if("all"===e)return{entities:t,relations:i};let r=s[e],n=a[e],l=i.filter(e=>r.includes(e.relation_type)),o=new Set;return l.forEach(e=>{o.add(e.source_id),o.add(e.target_id)}),{entities:l.length>0?t.filter(e=>o.has(e.id)):t.filter(e=>n.includes(e.type)),relations:l}})(m,e,h),[m,e,h]),v=(0,i.useMemo)(()=>({companies:_.filter(e=>["company","organization"].includes(e.type)),persons:_.filter(e=>"person"===e.type),others:_.filter(e=>!["company","organization","person"].includes(e.type))}),[_]),N=(0,i.useCallback)((e,t)=>{t?b.current.set(e,t):b.current.delete(e)},[]);(0,i.useEffect)(()=>{let e=setTimeout(()=>{u.current&&(f(u.current.getBoundingClientRect()),j({}))},100);return()=>clearTimeout(e)},[_,w,m]),(0,i.useEffect)(()=>{let e=()=>{u.current&&(f(u.current.getBoundingClientRect()),j({}))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let k=(0,i.useMemo)(()=>{let e=new Map,t=new Map;return w.forEach((i,r)=>{let n=[i.source_id,i.target_id].sort().join("-"),s=e.get(n)||0;t.set(r,s),e.set(n,s+1)}),{pairCount:e,pairIndex:t}},[w]);if(0===e.length)return(0,t.jsx)("div",{className:"h-[200px] flex items-center justify-center text-gray-400",children:(0,t.jsx)("p",{className:"text-sm",children:y.relationship.noEntitiesOrRelations})});let $=v.companies.length>0||v.persons.length>0||v.others.length>0;return(0,t.jsxs)("div",{className:"bg-white border border-gray-100 rounded-lg",children:[(0,t.jsx)("div",{className:"border-b border-gray-100 px-4 pt-4",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:n.map(e=>{var i;let r;return(0,t.jsx)("button",{onClick:()=>g(e.key),className:`px-3 py-2 text-xs font-medium rounded-t-lg transition-colors ${m===e.key?"bg-rose-50 text-rose-700 border-b-2 border-rose-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:(i=e.labelKey,(r=y.relationship.graphTabs)&&"object"==typeof r&&i in r?r[i]:({all:"Overview",qualifying_relationship:"Corporate",qualifying_employment:"Employment",qualifying_capacity:"Capacity",doing_business:"Operations"})[i]||i)},e.key)})})}),(0,t.jsx)("div",{ref:u,className:"relative p-6 min-h-[400px]",children:$?(0,t.jsxs)(t.Fragment,{children:[x&&(0,t.jsxs)("svg",{className:"absolute inset-0 pointer-events-none z-0",style:{overflow:"visible",width:"100%",height:"100%"},children:[(0,t.jsx)("defs",{children:(0,t.jsx)("marker",{id:"arrowhead",markerWidth:"8",markerHeight:"8",refX:"7",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:(0,t.jsx)("path",{d:"M0,0 L0,6 L8,3 z",fill:"#94a3b8"})})}),w.map((e,i)=>{let r=b.current.get(e.source_id),n=b.current.get(e.target_id);if(!r||!n||!u.current)return null;let s=r.getBoundingClientRect(),a=n.getBoundingClientRect(),o=u.current.getBoundingClientRect(),p=[e.source_id,e.target_id].sort().join("-"),d=k.pairCount.get(p)||1,{path:c,labelX:h,labelY:m}=((e,t,i,r,n)=>{let s,a,l,o,p,d,c,h=e.left+e.width/2-i.left,y=e.top+e.height/2-i.top,m=t.left+t.width/2-i.left,g=t.top+t.height/2-i.top,u=g-y,x=m-h,f=u>20,b=n>1?(r-(n-1)/2)*15:0;if(f||u<-20)if(f){s=h+b,a=e.bottom-i.top,l=m+b;let r=(a+(o=t.top-i.top))/2,n=.3*x;p=`M ${s} ${a} C ${s+.5*n} ${r}, ${l-.5*n} ${r}, ${l} ${o}`,d=(s+l)/2,c=r}else{s=h+b,a=e.top-i.top,l=m+b;let r=(a+(o=t.bottom-i.top))/2,n=.3*x;p=`M ${s} ${a} C ${s+.5*n} ${r}, ${l-.5*n} ${r}, ${l} ${o}`,d=(s+l)/2,c=r}else{x>0?(s=e.right-i.left,l=t.left-i.left):(s=e.left-i.left,l=t.right-i.left),a=y+b,o=g+b;let r=(s+l)/2,n=.1*Math.abs(x)+20;p=`M ${s} ${a} Q ${r} ${a-n}, ${l} ${o}`,d=r,c=a-n/2}return{path:p,labelX:d,labelY:c}})(s,a,o,k.pairIndex.get(i)||0,d),g=l(e.relation_type,y),x=Math.max(8*g.length+12,60);return(0,t.jsxs)("g",{children:[(0,t.jsx)("path",{d:c,stroke:"#cbd5e1",strokeWidth:"1.5",fill:"none",markerEnd:"url(#arrowhead)"}),(0,t.jsx)("rect",{x:h-x/2,y:m-9,width:x,height:"18",fill:"white",rx:"3",stroke:"#e2e8f0",strokeWidth:"1"}),(0,t.jsx)("text",{x:h,y:m+4,textAnchor:"middle",fontSize:"10",fill:"#be123c",children:g})]},i)})]}),(0,t.jsxs)("div",{className:"space-y-4 relative z-10",children:[v.companies.length>0&&(0,t.jsx)(d,{title:o("companies",y),children:v.companies.map(e=>(0,t.jsx)(p,{entity:e,t:y,ref:t=>N(e.id,t)},e.id))}),v.persons.length>0&&(0,t.jsx)(d,{title:o("persons",y),children:v.persons.map(e=>(0,t.jsx)(p,{entity:e,t:y,ref:t=>N(e.id,t)},e.id))}),v.others.length>0&&(0,t.jsx)(d,{title:o("others",y),children:v.others.map(e=>(0,t.jsx)(p,{entity:e,t:y,ref:t=>N(e.id,t)},e.id))})]}),w.length>0&&(0,t.jsxs)("div",{className:"mt-8 pt-4 border-t border-gray-100 relative z-10",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:[y.relationship.relationDetails||"Relation Details",":"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:w.map((i,r)=>(0,t.jsx)(c,{relation:i,entities:e,t:y},r))})]})]}):(0,t.jsx)("div",{className:"h-[200px] flex items-center justify-center text-gray-400",children:(0,t.jsx)("p",{className:"text-sm",children:y.relationship.noEntitiesOrRelations})})})]})}e.s(["default",()=>h])},66673,e=>{e.n(e.i(563))}]);